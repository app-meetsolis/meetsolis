# Story 2.2: Client Dashboard UI (Grid View)

## Status

Draft

---

## Story

**As a** user,
**I want** to see all my clients in a clean grid layout,
**so that** I can quickly find and access client information.

---

## Acceptance Criteria

1. Dashboard page matches reference design (3-column grid)
2. Client cards display: Name, Role/Company, Last Meeting date, Active Projects count
3. "+ Add Client" button (top-right)
4. Empty state: "No clients yet. Add your first client to get started."
5. Loading state: Skeleton cards (shimmer effect)
6. Error state: Error message with retry button
7. Card hover effect: Lift (translateY -4px), shadow increase
8. Click card → Navigate to client detail page
9. Responsive: 3 cols (desktop), 2 cols (tablet), 1 col (mobile)

---

## Tasks / Subtasks

- [ ] **Task 1: Client Dashboard Page** (AC: 1, 3)
  - [ ] Create `apps/web/src/app/clients/page.tsx`
  - [ ] Add page metadata (title: "Clients | MeetSolis")
  - [ ] Implement layout: Header with "+ Add Client" button (top-right)
  - [ ] Add background color: #E8E4DD (light beige)
  - [ ] Set up data fetching from `/api/clients`
  - [ ] Handle loading, error, and success states

- [ ] **Task 2: ClientCard Component** (AC: 2, 7, 8)
  - [ ] Create `apps/web/src/components/clients/ClientCard.tsx`
  - [ ] Props: `client` object (id, name, company, role, last_meeting_at)
  - [ ] Display client name (20px bold, #1A1A1A)
  - [ ] Display role/company (14px regular, #6B7280)
  - [ ] Display last meeting date (formatted: "Last meeting: 2 days ago" or "No meetings yet")
  - [ ] Display active projects count badge (#F3F4F6 background, 11px uppercase)
  - [ ] Add hover effect: `hover:translate-y-[-4px] hover:shadow-lg transition-all`
  - [ ] Make card clickable → `router.push(`/clients/${client.id}`)`
  - [ ] Card styling: White background, 8px border-radius, subtle shadow

- [ ] **Task 3: ClientGrid Component** (AC: 1, 9)
  - [ ] Create `apps/web/src/components/clients/ClientGrid.tsx`
  - [ ] Props: `clients` array
  - [ ] Implement grid layout: `grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6`
  - [ ] Map clients to ClientCard components
  - [ ] Ensure responsive breakpoints work correctly

- [ ] **Task 4: Empty State** (AC: 4)
  - [ ] Create `apps/web/src/components/clients/ClientEmptyState.tsx`
  - [ ] Display when clients.length === 0
  - [ ] Show message: "No clients yet. Add your first client to get started."
  - [ ] Include "+ Add Client" button (centered)
  - [ ] Add illustration/icon (optional)

- [ ] **Task 5: Loading State** (AC: 5)
  - [ ] Create `apps/web/src/components/clients/ClientGridSkeleton.tsx`
  - [ ] Render 6 skeleton cards (shimmer effect)
  - [ ] Use Shadcn Skeleton component: `<Skeleton className="h-48 w-full" />`
  - [ ] Match grid layout (3 cols desktop, 2 cols tablet, 1 col mobile)
  - [ ] Add shimmer animation

- [ ] **Task 6: Error State** (AC: 6)
  - [ ] Create `apps/web/src/components/clients/ClientErrorState.tsx`
  - [ ] Display error message: "Failed to load clients. Please try again."
  - [ ] Add "Retry" button → re-fetch clients
  - [ ] Show error icon/illustration
  - [ ] Use Shadcn Alert component for styling

- [ ] **Task 7: Data Fetching Logic** (AC: 1)
  - [ ] Implement client-side data fetching in page.tsx
  - [ ] Use `@tanstack/react-query` for data management
  - [ ] Query key: `['clients']`
  - [ ] Fetch function: `GET /api/clients`
  - [ ] Handle loading, error, success states
  - [ ] Enable automatic refetch on window focus

- [ ] **Task 8: Navigation Integration** (AC: 8)
  - [ ] Add dashboard link to main navigation
  - [ ] Update sidebar/header menu: "Clients" link → `/clients`
  - [ ] Ensure protected route (requires authentication)

- [ ] **Task 9: Responsive Testing** (AC: 9)
  - [ ] Test desktop view (1440px+): 3 columns
  - [ ] Test tablet view (768px-1439px): 2 columns
  - [ ] Test mobile view (<768px): 1 column
  - [ ] Verify hover effects work on desktop
  - [ ] Verify touch interactions work on mobile

- [ ] **Task 10: Component Tests**
  - [ ] Test ClientCard renders correctly with client data
  - [ ] Test ClientCard navigation on click
  - [ ] Test ClientGrid renders multiple cards
  - [ ] Test EmptyState displays when no clients
  - [ ] Test LoadingState shows skeleton cards
  - [ ] Test ErrorState shows error message and retry button

---

## Dev Notes

### Relevant Architecture

**Design Specs (from Epic 2 PRD):**
- Background: #E8E4DD (light beige)
- Cards: White, 8px border-radius, subtle shadow
- Client name: 20px bold, #1A1A1A
- Role/Company: 14px regular, #6B7280
- Badge: #F3F4F6 background, 11px uppercase
- Hover: translateY(-4px), shadow increase
- Grid: 3 cols (desktop), 2 cols (tablet), 1 col (mobile)

**Component Library:**
- Use Shadcn UI components: Button, Card, Skeleton, Alert
- Icons: Lucide React icons

**State Management:**
- Use @tanstack/react-query for server state
- Query key: `['clients']`
- Automatic refetch on window focus
- Cache for 5 minutes

**Source Tree:**
- Page: `apps/web/src/app/clients/page.tsx`
- Components: `apps/web/src/components/clients/`
  - `ClientCard.tsx`
  - `ClientGrid.tsx`
  - `ClientEmptyState.tsx`
  - `ClientGridSkeleton.tsx`
  - `ClientErrorState.tsx`

**Important Notes:**
- Page is protected route (middleware validates auth)
- API route `/api/clients` returns array of clients for authenticated user
- Last meeting date calculated from `last_meeting_at` timestamp (use date-fns for formatting)
- Active projects count = meetings in last 30 days (calculated or pre-computed)

**Example Client Object:**
```typescript
interface Client {
  id: string;
  user_id: string;
  name: string;
  company: string | null;
  role: string | null;
  email: string | null;
  phone: string | null;
  website: string | null;
  linkedin_url: string | null;
  tags: string[];
  status: 'active' | 'inactive' | 'archived';
  created_at: string;
  updated_at: string;
  last_meeting_at: string | null;
}
```

### Testing

**Test Location:**
- Component tests: `apps/web/src/components/clients/__tests__/`
- Page tests: `apps/web/src/app/clients/__tests__/`

**Testing Standards:**
- Use Jest + Testing Library for component tests
- Mock react-query with `@testing-library/react` utilities
- Mock Next.js router for navigation tests

**Specific Requirements:**
- Test responsive grid layout (mock window.matchMedia)
- Test loading skeleton display
- Test empty state when no clients
- Test error state and retry functionality
- Test client card click navigation

**Example Test Pattern:**
```typescript
import { render, screen } from '@testing-library/react';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import ClientCard from '../ClientCard';

const queryClient = new QueryClient();

test('renders client card with client data', () => {
  const client = {
    id: '1',
    name: 'Acme Corp',
    company: 'Acme Inc',
    role: 'CEO',
    last_meeting_at: '2026-01-05',
  };

  render(
    <QueryClientProvider client={queryClient}>
      <ClientCard client={client} />
    </QueryClientProvider>
  );

  expect(screen.getByText('Acme Corp')).toBeInTheDocument();
  expect(screen.getByText('CEO at Acme Inc')).toBeInTheDocument();
});
```

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-07 | 1.0 | Initial story creation | Sarah (PO) |

---

## Dev Agent Record

*This section will be populated by the development agent during implementation.*

### Agent Model Used

*TBD*

### Debug Log References

*TBD*

### Completion Notes List

*TBD*

### File List

*TBD*

---

## QA Results

*This section will be populated by the QA agent after story completion.*
